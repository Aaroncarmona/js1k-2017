I=x=>(x+360)%360;l=(x,y,z)=>x<y&&y<z;t=(x,y)=>l(0,y/6%51,1)?70:y%6&&(x+(y/6|0)%2*6)%12&&(t(x+1,y)?80:60);P=x=>x/60|0;v=[M=Math];for(s=i=120;o=n=u=s--;)v[s]=s*28%64<39-s/4;k=M.min;p=17;$=2;r=-20;S=[];onkeydown=onkeyup=e=>{S[R=e.which-37]=e.type[5];$=R%2?$:R};setInterval(e=>{p=I(p-!!S[0]*4+!!S[2]*4);s=-k(S[1]&&i&&i--?5:10,1-s);o+=s;r+=(y=o-r)>110?y-110:y<5?y-5:0;if(u=o>1228)o=S[2]=1230,s=0;if(s<0&v[P(o)*6+P(I(98+p))]&l(s,o%60-32,0)&l(0,(p+38)%60,52))o+=30-o%60,s=14;s=o>0?s:14;for(x=120;x--;)for(a=M.acos(x/60%2-1),xp=(1-a/M.PI)*180|0,y=160;y--;)w=l(o,y+r,o+24)&l(82,xp,98)&&(e=I($?xp-83:99-xp),f=y+r-o,f<0|47-e<f*2|f<20-e*3&f>e*5-4|e*2>37-f&e+4>f?0:e+7-f?e*2>30-f&e+4>f?99:9:30)||(r<-y?9+y+r:r+y>1230?u?M.atan2(120-y,x-60)*8+p/9*M.PI&1&&40:10:M.sin(a)*40-60+((e=I(xp+p),f=y+r)&&f<42&l(126,e,150)?40-x%2*3:v[P(f)*6+P(e)]&&(l(24,f%60,30)&l(0,e%60,36)?90:l(30,f%60,54)&l(6,e%60,30))||t(e,f))),d=k(1,-k(0,M.hypot(60-x,o-y-r+12)/12-2))*i,c.fillStyle=`hsl(${240+d|0},20%,${w+d/6|0}%`,c.fillRect(x*4,640-y*4,4,4)},42)