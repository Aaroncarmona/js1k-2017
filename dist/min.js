r=(x,y)=>y<0|47-x<y*2|y<20-x*3&y>x*5-4|x*2>37-y&x+4>y?0:x+7-y?x*2>30-y&x+4>y?99:9:30;h=x=>(x+360)%360;l=(x,y,z)=>x<y&&y<z;o=(x,y)=>l(18,y,20)&l(130,x,133)?20:y&&y<42&l(126,x,150)?40:p[(y/60|0)*6+x/60|0]&&(l(24,y%60,30)&l(0,x%60,36)?90:l(30,y%60,54)&l(6,x%60,30))||y%6&&(x+(y/6|0)%2*6)%12&&80;M=Math;p=[];for(n=f=120;k=i=n--;)p[n]=(n*11+n*17)%64<39-n/4;I=17;S=2;m=-20;R=[];onkeydown=onkeyup=e=>{R[P=e.which-37]=e.type[5];S=P%2?S:P};setInterval(e=>{I=h(I-!!R[0]*4+!!R[2]*4);n>-(R[1]&&f&&f--?3:12)&&n--;k+=n;m+=k-m>110?k-m-110:k-m<5?k-m-5:0;if(n<0&p[(k/60|0)*6+h(98+I)/60|0]&l(n,k%60-31,0)&l(0,52-(I+38)%60,52))k+=30-k%30,n=12;n=k>0?n:12;for(x=120;x--;){a=M.acos(x/60%2-1);xp=(1-a/M.PI)*180|0;for(y=160;y--;)w=l(k,y+m,k+24)&l(82,xp,98)&&r(h(S?xp-83:99-xp),y+m-k)||(m<-y||m+y>1230?10:M.sin(a)*40-60+o(h(xp+I),y+m)),d=M.min(1,M.max(0,2-M.hypot(60-x,k-y-m+12)/12))*f,c.fillStyle=`hsl(${240+d|0},20%,${w+d/6|0}%`,c.fillRect(x*4,640-y*4,4,4)}},42)