i=x=>(x+360)%360;l=(x,y,z)=>x<y&&y<z;p=(x,y)=>y%6&&(x+(y/6|0)%2*6)%12&&(p(x+1,y)?80:60);r=[M=Math];for(o=h=120;I=k=o--;)r[o]=(o*11+o*17)%64<39-o/4;m=17;S=2;n=-20;R=[];onkeydown=onkeyup=e=>{R[P=e.which-37]=e.type[5];S=P%2?S:P};setInterval(e=>{m=i(m-!!R[0]*4+!!R[2]*4);o>-(R[1]&&h&&h--?3:12)&&o--;I+=o;n+=I-n>110?I-n-110:I-n<5?I-n-5:0;if(o<0&r[(I/60|0)*6+i(98+m)/60|0]&l(o,I%60-31,0)&l(0,52-(m+38)%60,52))I+=30-I%30,o=12;o=I>0?o:12;for(x=120;x--;){a=M.acos(x/60%2-1);xp=(1-a/M.PI)*180|0;for(y=160;y--;)w=l(I,y+n,I+24)&l(82,xp,98)&&(e=i(S?xp-83:99-xp),f=y+n-I,f<0|47-e<f*2|f<20-e*3&f>e*5-4|e*2>37-f&e+4>f?0:e+7-f?e*2>30-f&e+4>f?99:9:30)||(n<-y?(y+x&1)*7+y:n+y>1230?10:M.sin(a)*40-60+(l(18,f=y+n,20)&l(130,e=i(xp+m),133)?20:f&&f<42&l(126,e,150)?40:r[(f/60|0)*6+e/60|0]&&(l(24,f%60,30)&l(0,e%60,36)?90:l(30,f%60,54)&l(6,e%60,30))||p(e,f))),d=M.min(1,M.max(0,2-M.hypot(60-x,I-y-n+12)/12))*h,c.fillStyle=`hsl(${240+d|0},20%,${w+d/6|0}%`,c.fillRect(x*4,640-y*4,4,4)}},42)