R=(x,y,z)=>(x+360)%360,i=(x,y,z)=>x<y&&y<z;m=(x,y,z)=>i(0,y/6%51,1)?7:y%6&&(x+(y/6&1)*6)%12&&(m(x+1,y)?8:6);M=(x,y,z)=>x/60|0,o=(x,y,z)=>(z=M(y)*6+M(x))*28%64<39-z/4;for(k=[x=360];S=n=g=h=x--;){for(k[x]=[I=y=1230];y--;)k[x][y]=y<42&&i(126,x,P=150)?x&3:o(x,y)&&(i(24,y%60,30)&&i(0,x%60,36)?9:i(30,y%60,54)&&i(6,x%60,30))||m(x,y);b=-12}onkeydown=onkeyup=(x,y,z)=>c[39-x.which]=x.type[5];setInterval(x=(x,y,z)=>{g++;w=!c[2]-!c[0];$=R($+w*4);S+=h=-Math.min(c[1]&&P&&P--?3:10,1-h);b+=(y=S-b)>110?y-110:y<5&&y-5;n=S>1228?S=c[h=0]=I:0,(M(S)-19||g%60<30)&&o(R(98+$),S)&&i(h,S%60-30,1)&&i(0,($+38)%60,52)&&(S+=30-S%60,h=14);S>0||(h=14,S=-2);(x=(x,y,z)=>{for(c.fillRect(0,0,a.width^=0,640);x--;)for(e=R(~w?x-53:69-x),y=160;y--;)z=b+y,d=Math.min(1,-Math.min(0,Math.hypot(60-x,12-z+S)/12-2))*P/2,l=i(0,f=z-S+!n*Math.sin(x/2)*(14-Math.hypot(h))/8|0,24)&&i(52,x,68)&&!(f<0||47-e<f*2||f/3<6-e&&f>e*5-4||e*2>37-f&&e+4>f)?e+7-f?e*2>30-f&&e+4>f?9:2:4:z<0?2+z/6:z>I?n?(x-60)/(100-y)*5+g/4&1&&4:1:Math.sin(r=Math.acos(x/60%2-1))*4-6+k[R((1-r/Math.PI)*180+$|0)][M(z)-19||g%60<30?z:z%12+60],l>1&&(d*=l/5,c.fillStyle=`rgb(${30+l*8+d*3|0},${30+l*8+d*2|0},${40+l*16+d|0})`,c.fillRect(x*4,636-y*4,4,4))})(120)},$=42)